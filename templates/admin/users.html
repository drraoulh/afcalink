{% extends "base.html" %}

{% block page_title %}Gestion de l'Équipe{% endblock %}

{% block content %}
<div class="row g-4 mb-5 animate-in">
    <div class="col-12">
        <div class="card border-0 shadow-premium p-4 bg-primary text-white overflow-hidden position-relative"
            style="border-radius: 24px;">
            <div class="position-absolute top-0 end-0 p-5 opacity-10">
                <i data-lucide="users" style="width: 150px; height: 150px;"></i>
            </div>
            <div class="position-relative">
                <h3 class="fw-extrabold mb-1">Collaborateurs</h3>
                <p class="opacity-75 mb-0">Gérez les membres de votre équipe et leurs niveaux d'accès</p>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Formulaire Nouvel Utilisateur -->
    <div class="col-12 col-xl-4">
        <div class="card border-0 shadow-premium p-4 h-100 animate-in" style="animation-delay: 0.1s;">
            <h5 class="fw-bold mb-4">Nouvel Utilisateur</h5>
            <form action="/admin/users/new" method="post">
                <div class="mb-3">
                    <label class="form-label smaller fw-bold text-muted">Nom Complet</label>
                    <input type="text" name="full_name" class="form-control bg-light border-0 py-2 px-3 rounded-3"
                        placeholder="Ex: Jean Paul" required>
                </div>
                <div class="mb-3">
                    <label class="form-label smaller fw-bold text-muted">Email Professionnel</label>
                    <input type="email" name="email" class="form-control bg-light border-0 py-2 px-3 rounded-3"
                        placeholder="email@afcalink.com" required>
                </div>
                <div class="mb-3">
                    <label class="form-label smaller fw-bold text-muted">Mot de passe provisoire</label>
                    <input type="password" name="password" class="form-control bg-light border-0 py-2 px-3 rounded-3"
                        required>
                </div>
                <div class="mb-4">
                    <label class="form-label smaller fw-bold text-muted">Rôle & Permissions</label>
                    <select name="role" class="form-select bg-light border-0 py-2 px-3 rounded-3" required>
                        <option value="agent">Agent Commercial</option>
                        <option value="secretary">Secrétariat & Comptabilité</option>
                        <option value="admission_director">Directeur Admission</option>
                        <option value="operation_director">Directeur Opérations</option>
                        <option value="admin">Administrateur</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary w-100 py-3 rounded-pill fw-bold shadow-primary-sm">
                    <i data-lucide="user-plus" class="me-2" style="width: 18px;"></i>
                    Créer le compte
                </button>
            </form>
        </div>
    </div>

    <!-- Liste des Utilisateurs -->
    <div class="col-12 col-xl-8">
        <div class="card border-0 shadow-premium p-4 h-100 animate-in" style="animation-delay: 0.2s;">
            <h5 class="fw-bold mb-4">Équipe Actuelle</h5>
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="bg-light-soft">
                        <tr>
                            <th class="ps-4 py-3 text-muted extra-small text-uppercase fw-bold">Nom & Email</th>
                            <th class="py-3 text-muted extra-small text-uppercase fw-bold text-center">Rôle</th>
                            <th class="py-3 text-muted extra-small text-uppercase fw-bold text-center">Statut</th>
                            <th class="pe-4 py-3 text-end">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for u in users %}
                        <tr>
                            <td class="ps-4 py-3">
                                <div class="fw-bold text-dark">{{ u.full_name }}</div>
                                <div class="extra-small text-muted">{{ u.email }}</div>
                            </td>
                            <td class="py-3 text-center">
                                {% if u.role == 'admin' %}
                                <span class="badge bg-dark px-3 py-1 rounded-pill">Admin</span>
                                {% elif u.role == 'secretary' %}
                                <span class="badge bg-info-soft text-info px-3 py-1 rounded-pill">Secrétariat /
                                    Comptable</span>
                                {% elif u.role == 'admission_director' %}
                                <span class="badge bg-primary-soft text-primary px-3 py-1 rounded-pill">Dir.
                                    Admission</span>
                                {% elif u.role == 'operation_director' %}
                                <span class="badge bg-success-soft text-success px-3 py-1 rounded-pill">Dir.
                                    Opérations</span>
                                {% else %}
                                <span class="badge bg-primary-soft text-primary px-3 py-1 rounded-pill">Agent</span>
                                {% endif %}
                            </td>
                            <td class="py-3 text-center">
                                <span
                                    class="badge bg-success-soft text-success rounded-pill px-2 py-1 extra-small">Actif</span>
                            </td>
                            <td class="pe-4 py-3 text-end">
                                <button class="btn btn-light btn-sm rounded-circle" title="Modifier" disabled>
                                    <i data-lucide="edit-3" style="width: 14px;"></i>
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<style>
    .fw-extrabold {
        font-weight: 800;
    }

    .extra-small {
        font-size: 0.65rem;
    }

    .bg-light-soft {
        background-color: #f8fafc;
    }

    .shadow-primary-sm {
        box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.25);
    }
</style>
{% endblock %}